#!/usr/bin/env bash
#MISE description="Build the project"
#MISE sources=["src/**/*"]
#MISE outputs=["dist/index.js", "dist/index.d.ts"]

set -e

rm -rf dist
mkdir -p dist

bun build ./src/index.ts --outdir dist --target bun --external "@opencode-ai/*"

cat > dist/index.d.ts <<'EOF'
import type { Plugin } from '@opencode-ai/plugin';

declare const plugin: Plugin;
export default plugin;
EOF
